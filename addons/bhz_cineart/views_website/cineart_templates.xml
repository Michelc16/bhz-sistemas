<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <template id="guiabh_cineart_page" name="GuiaBH - Cineart" page="True">
        <t t-call="website.layout">
            <div class="container py-4">
                <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3">
                    <div>
                        <h1 class="mb-1">Cineart</h1>
                        <p class="text-muted mb-0">Em cartaz, em breve e estreias da semana.</p>
                    </div>
                    <a class="btn btn-outline-secondary" href="https://cineart.com.br/" target="_blank" rel="noopener">
                        Ver no site do Cineart
                    </a>
                </div>
                <ul class="nav nav-tabs" id="cineartTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="tab-now" data-bs-toggle="tab" data-bs-target="#pane-now" type="button" role="tab">
                            Em cartaz
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="tab-soon" data-bs-toggle="tab" data-bs-target="#pane-soon" type="button" role="tab">
                            Em breve
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="tab-premiere" data-bs-toggle="tab" data-bs-target="#pane-premiere" type="button" role="tab">
                            Estreias da semana
                        </button>
                    </li>
                </ul>
                <div class="tab-content pt-3">
                    <div class="tab-pane fade show active" id="pane-now" role="tabpanel">
                        <t t-call="guiabh_cineart._cineart_grid">
                            <t t-set="movies" t-value="now_movies"/>
                        </t>
                    </div>
                    <div class="tab-pane fade" id="pane-soon" role="tabpanel">
                        <t t-call="guiabh_cineart._cineart_grid">
                            <t t-set="movies" t-value="soon_movies"/>
                        </t>
                    </div>
                    <div class="tab-pane fade" id="pane-premiere" role="tabpanel">
                        <t t-call="guiabh_cineart._cineart_grid">
                            <t t-set="movies" t-value="premiere_movies"/>
                        </t>
                    </div>
                </div>
            </div>
        </t>
    </template>
    <template id="_cineart_grid">
        <t t-if="not movies">
            <div class="alert alert-info">
                Ainda não temos itens aqui. (O sincronizador pode estar rodando — tente atualizar mais tarde.)
            </div>
        </t>
        <div class="row g-3" t-if="movies">
            <t t-foreach="movies" t-as="m">
                <div class="col-6 col-md-4 col-lg-3">
                    <a t-att-href="m.cineart_url or '#'" t-att-target="'_blank' if m.cineart_url else None" class="text-decoration-none">
                        <div class="card h-100 shadow-sm">
                            <t t-if="m.poster_image">
                                <img class="card-img-top"
                                     t-att-src="'data:image/png;base64,%s' % (m.poster_image.decode() if hasattr(m.poster_image,'decode') else m.poster_image)"
                                     style="aspect-ratio: 2/3; object-fit: cover;" alt="Poster"/>
                            </t>
                            <t t-elif="m.poster_url">
                                <img class="card-img-top" t-att-src="m.poster_url" style="aspect-ratio: 2/3; object-fit: cover;" alt="Poster"/>
                            </t>
                            <t t-else="">
                                <div class="bg-light d-flex align-items-center justify-content-center" style="aspect-ratio: 2/3;">
                                    <span class="text-muted">Sem imagem</span>
                                </div>
                            </t>
                            <div class="card-body">
                                <h6 class="card-title mb-2" t-esc="m.name"/>
                                <div class="d-flex flex-wrap gap-2">
                                    <t t-if="m.genre">
                                        <span class="badge text-bg-secondary" t-esc="m.genre"/>
                                    </t>
                                    <t t-if="m.age_rating">
                                        <span class="badge text-bg-danger">
                                            <t t-esc="m.age_rating"/>
                                        </span>
                                    </t>
                                    <t t-if="m.release_date">
                                        <span class="badge text-bg-warning">
                                            <t t-esc="m.release_date"/>
                                        </span>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </t>
        </div>
    </template>
</templates>
