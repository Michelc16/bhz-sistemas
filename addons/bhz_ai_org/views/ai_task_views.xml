<odoo>
  <record id="view_bhz_ai_task_tree" model="ir.ui.view">
    <field name="name">bhz.ai.task.tree</field>
    <field name="model">bhz.ai.task</field>
    <field name="arch" type="xml">
      <tree>
        <field name="name"/>
        <field name="state"/>
        <field name="agent_id"/>
        <field name="requester_user_id"/>
        <field name="create_date"/>
      </tree>
    </field>
  </record>

  <record id="view_bhz_ai_task_form" model="ir.ui.view">
    <field name="name">bhz.ai.task.form</field>
    <field name="model">bhz.ai.task</field>
    <field name="arch" type="xml">
      <form>
        <header>
          <button name="action_plan" type="object" string="Plan" class="btn-primary" attrs="{'invisible':[('state','!=','draft')]}"/>
          <button name="action_approve" type="object" string="Approve" class="btn-secondary" groups="bhz_ai_org.group_bhz_ai_approver" attrs="{'invisible':[('state','!=','waiting_approval')]}"/>
          <button name="action_run_now" type="object" string="Run Now" class="btn-primary" attrs="{'invisible':[('state','!=','planned')]}"/>
          <field name="state" widget="statusbar" statusbar_visible="draft,planned,waiting_approval,running,done,failed"/>
        </header>

        <sheet>
          <group>
            <field name="name"/>
            <field name="agent_id"/>
            <field name="requester_user_id" readonly="1"/>
            <field name="approval_required" readonly="1"/>
            <field name="approved_by_id" readonly="1"/>
            <field name="approved_on" readonly="1"/>
          </group>

          <notebook>
            <page string="Input">
              <field name="user_input" placeholder="Descreva o que a IA deve fazer..."/>
            </page>
            <page string="Plan">
              <field name="plan_json" widget="text"/>
            </page>
            <page string="Actions">
              <field name="action_ids">
                <tree editable="bottom">
                  <field name="sequence"/>
                  <field name="tool_id"/>
                  <field name="state"/>
                  <field name="params_json"/>
                </tree>
              </field>
            </page>
            <page string="Result">
              <field name="result_text" widget="text" readonly="1"/>
              <field name="error_text" widget="text" readonly="1"/>
            </page>
          </notebook>
        </sheet>
      </form>
    </field>
  </record>

  <record id="action_bhz_ai_task" model="ir.actions.act_window">
    <field name="name">AI Tasks</field>
    <field name="res_model">bhz.ai.task</field>
    <field name="view_mode">tree,form</field>
  </record>

  <menuitem id="menu_bhz_ai_task_open" parent="bhz_ai_tasks_menu" action="action_bhz_ai_task" sequence="10"/>
</odoo>
