<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- SNIPPET VISUAL -->
    <template id="s_guiabh_featured_carousel" name="GuiaBH - Carrossel de Destaques">
        <section class="s_guiabh_featured_carousel py-5">
            <div class="container">
                <t t-set="Event" t-value="request.env['event.event'].sudo()"/>
                <t t-set="events"
                   t-value="Event.search([
                        ('show_on_public_agenda','=',True),
                        ('is_featured','=',True),
                        ('website_published','=',True)
                   ], limit=8, order='date_begin asc')"/>

                <t t-if="events">
                    <div id="guiabhFeaturedCarousel" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-inner">
                            <t t-foreach="events" t-as="event" t-foreach-index="i">
                                <div class="carousel-item" t-att-class="'active' if i == 0 else ''">
                                    <a t-att-href="'/agenda/event/%s' % event.id">
                                        <img class="d-block w-100 rounded-4"
                                             t-att-src="'/web/image/event.event/%s/promo_cover_image' % event.id"
                                             t-att-alt="event.name or ''"/>
                                    </a>
                                </div>
                            </t>
                        </div>

                        <button class="carousel-control-prev" type="button"
                                data-bs-target="#guiabhFeaturedCarousel" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon"/>
                            <span class="visually-hidden">Anterior</span>
                        </button>
                        <button class="carousel-control-next" type="button"
                                data-bs-target="#guiabhFeaturedCarousel" data-bs-slide="next">
                            <span class="carousel-control-next-icon"/>
                            <span class="visually-hidden">Pr√≥ximo</span>
                        </button>
                    </div>
                </t>

                <t t-else="">
                    <div class="alert alert-secondary text-center">
                        Nenhum evento em destaque no momento.
                    </div>
                </t>
            </div>
        </section>
    </template>

    <!-- REGISTRO NO BUILDER -->
    <template id="guiabh_featured_carousel_snippet_menu"
              inherit_id="website.snippets"
              name="GuiaBH - Carrossel de Destaques (Menu)">
        <xpath expr="." position="inside">
            <we-snippet
                data-name="GuiaBH - Carrossel de Destaques"
                data-snippet="bhz_event_promo.s_guiabh_featured_carousel"
                data-thumbnail="/bhz_event_promo/static/description/featured_carousel.png"
                data-categories="Events,Dynamic,GuiaBH"/>
        </xpath>
    </template>

</odoo>
