<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="s_guiabh_featured_carousel" name="GuiaBH - Carrossel de Destaques">
        <section class="s_guiabh_featured_carousel oe_snippet_body py-5"
                 data-snippet="bhz_event_promo.s_guiabh_featured_carousel"
                 data-name="GuiaBH - Carrossel de Destaques"
                 data-limit="12"
                 data-interval="5000">
            <div class="container">
                <t t-set="events"
                   t-value="request.env['event.event'].guiabh_get_featured_events(12)"/>
                <t t-set="snippet_key" t-value="request.env.context.get('snippet_key') or request.env.uid or 0"/>
                <t t-set="website_id" t-value="request.env.context.get('website_id') or 0"/>
                <t t-set="carousel_id" t-value="'guiabh_featured_%s_%s' % (snippet_key, website_id)"/>
                <t t-set="carousel_target" t-value="'#%s' % carousel_id"/>
                <div class="guiabh-featured-carousel carousel slide"
                     t-att-id="carousel_id"
                     data-interval="5000"
                     data-bs-ride="false"
                     data-bs-interval="5000"
                     contenteditable="false">
                    <div class="carousel-inner">
                        <t t-call="bhz_event_promo.guiabh_featured_carousel_slides">
                            <t t-set="events" t-value="events"/>
                            <t t-set="carousel_target" t-value="carousel_target"/>
                        </t>
                    </div>
                    <div t-attf-class="o_carousel_controllers #{'d-none' if len(events) &lt;= 1 else ''}">
                        <button class="carousel-control-prev"
                                type="button"
                                data-bs-slide="prev"
                                t-attf-data-bs-target="{{ carousel_target }}"
                                aria-label="Anterior"
                                title="Anterior"
                                contenteditable="false">
                            <span class="carousel-control-prev-icon" aria-hidden="true"/>
                            <span class="visually-hidden">Anterior</span>
                        </button>
                        <div class="carousel-indicators" contenteditable="false">
                            <t t-call="bhz_event_promo.guiabh_featured_carousel_indicators">
                                <t t-set="events" t-value="events"/>
                                <t t-set="carousel_target" t-value="carousel_target"/>
                            </t>
                        </div>
                        <button class="carousel-control-next"
                                type="button"
                                data-bs-slide="next"
                                t-attf-data-bs-target="{{ carousel_target }}"
                                aria-label="Próximo"
                                title="Próximo"
                                contenteditable="false">
                            <span class="carousel-control-next-icon" aria-hidden="true"/>
                            <span class="visually-hidden">Próximo</span>
                        </button>
                    </div>
                </div>
                <div t-attf-class="alert alert-secondary mb-0 text-center js-guiabh-featured-empty #{'d-none' if events else ''}">
                    Nenhum evento em destaque no momento.
                </div>
            </div>
        </section>
    </template>

    <template id="guiabh_featured_carousel_slides" name="GuiaBH - Slides do carrossel">
        <t t-foreach="events" t-as="event" t-index="idx">
            <div t-attf-class="carousel-item #{'active' if idx == 0 else ''}">
                <a t-att-href="'/agenda/event/%s' % event.id">
                    <img class="d-block w-100 guiabh-slide-bg"
                         t-att-src="'/web/image/event.event/%s/promo_cover_image' % event.id"
                         t-att-alt="event.name or ''"
                         draggable="false"/>
                </a>
            </div>
        </t>
    </template>

    <template id="guiabh_featured_carousel_indicators" name="GuiaBH - Indicadores do carrossel">
        <t t-foreach="events" t-as="event" t-index="idx">
            <button type="button"
                    t-attf-data-bs-slide-to="{{ idx }}"
                    t-attf-data-bs-target="{{ carousel_target or '' }}"
                    t-attf-class="#{'active' if idx == 0 else ''}"
                    t-attf-aria-label="Slide {{ idx + 1 }}"
                    t-att-aria-current="idx == 0 and 'true' or False"></button>
        </t>
    </template>
</odoo>
